{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\USER\\\\Documents\\\\Work_hub\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\USER\\\\Documents\\\\Work_hub\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\USER\\\\Documents\\\\Work_hub\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"C:\\\\Users\\\\USER\\\\Documents\\\\Work_hub\\\\src\\\\context\\\\TransactionContext.jsx\";\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; }, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) }), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == typeof value && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; defineProperty(this, \"_invoke\", { value: function value(method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; } function maybeInvokeDelegate(delegate, context) { var methodName = context.method, method = delegate.iterator[methodName]; if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel; var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), defineProperty(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (val) { var object = Object(val), keys = []; for (var key in object) keys.push(key); return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nimport React, { useState, useEffect } from 'react';\nimport Web3 from 'web3';\nimport workchop from '../abis/workchop.json';\nimport \"reactstrap/lib/\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nexport var TransactionContext = React.createContext();\nvar _window = window,\n  ethereum = _window.ethereum;\nexport var TransactionProvider = function TransactionProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState({\n      web3: null,\n      contract: null,\n      email: '',\n      account: '',\n      accountId: '',\n      signedIn: false,\n      loaded: false\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    state = _useState2[0],\n    setState = _useState2[1];\n  var _useState3 = useState(\"\"),\n    _useState4 = _slicedToArray(_useState3, 2),\n    currentAccount = _useState4[0],\n    setCurrentAccount = _useState4[1];\n  var initWeb3 = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var web3, account, netId, address, contract, accountId;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            if (!window.ethereum) {\n              _context.next = 26;\n              break;\n            }\n            _context.next = 3;\n            return window.ethereum.request({\n              method: 'eth_requestAccounts'\n            });\n          case 3:\n            _context.prev = 3;\n            web3 = new Web3(window.ethereum);\n            _context.next = 7;\n            return web3.eth.getAccounts();\n          case 7:\n            account = _context.sent[0];\n            _context.next = 10;\n            return web3.eth.net.getId();\n          case 10:\n            netId = _context.sent;\n            address = workchop.networks[netId].address;\n            contract = new web3.eth.Contract(workchop.abi, address);\n            _context.next = 15;\n            return contract.methods.address_to_id(account).call();\n          case 15:\n            accountId = _context.sent;\n            setState(_objectSpread(_objectSpread({}, state), {}, {\n              web3: web3,\n              account: account,\n              contract: contract,\n              accountId: accountId,\n              loaded: true\n            }));\n            window.location.reload();\n            console.log('setup complete');\n            _context.next = 24;\n            break;\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](3);\n            alert(_context.t0);\n          case 24:\n            _context.next = 27;\n            break;\n          case 26:\n            alert('web3 not detected');\n          case 27:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[3, 21]]);\n    }));\n    return function initWeb3() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var connectWallet = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var accounts;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            if (ethereum) {\n              _context2.next = 3;\n              break;\n            }\n            return _context2.abrupt(\"return\", alert(\"Please install MetaMask.\"));\n          case 3:\n            _context2.next = 5;\n            return ethereum.request({\n              method: \"eth_requestAccounts\"\n            });\n          case 5:\n            accounts = _context2.sent;\n            setCurrentAccount(accounts[0]);\n            window.location.reload();\n            _context2.next = 14;\n            break;\n          case 10:\n            _context2.prev = 10;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n            throw new Error(\"No ethereum object\");\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[0, 10]]);\n    }));\n    return function connectWallet() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var login = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var accountType;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return state.contract.methods.login(state.email).call({\n              from: state.account\n            });\n          case 3:\n            accountType = _context3.sent;\n            console.log('account type:', accountType);\n            setState(_objectSpread(_objectSpread({}, state), {}, {\n              signedIn: true\n            }));\n            _context3.next = 11;\n            break;\n          case 8:\n            _context3.prev = 8;\n            _context3.t0 = _context3[\"catch\"](0);\n            console.error(_context3.t0);\n          case 11:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3, null, [[0, 8]]);\n    }));\n    return function login() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var signUp = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return state.contract.methods.sign_up(state.email, 'name', 'user').send({\n              from: state.account\n            });\n          case 3:\n            alert('signed up');\n            _context4.next = 9;\n            break;\n          case 6:\n            _context4.prev = 6;\n            _context4.t0 = _context4[\"catch\"](0);\n            console.error(_context4.t0);\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }, _callee4, null, [[0, 6]]);\n    }));\n    return function signUp() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var requestCompany = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(startDate, endDate, role, companyId) {\n      return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n        while (1) switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.prev = 0;\n            _context5.next = 3;\n            return state.contract.methods.add_experience(state.accountId, startDate, endDate, role, companyId);\n          case 3:\n            _context5.next = 8;\n            break;\n          case 5:\n            _context5.prev = 5;\n            _context5.t0 = _context5[\"catch\"](0);\n            console.error(_context5.t0);\n          case 8:\n          case \"end\":\n            return _context5.stop();\n        }\n      }, _callee5, null, [[0, 5]]);\n    }));\n    return function requestCompany(_x, _x2, _x3, _x4) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var approveEmployee = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(experienceId, companyId) {\n      return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n        while (1) switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.prev = 0;\n            _context6.next = 3;\n            return state.contract.methods.approve_experience(experienceId, companyId);\n          case 3:\n            _context6.next = 8;\n            break;\n          case 5:\n            _context6.prev = 5;\n            _context6.t0 = _context6[\"catch\"](0);\n            console.error(_context6.t0);\n          case 8:\n          case \"end\":\n            return _context6.stop();\n        }\n      }, _callee6, null, [[0, 5]]);\n    }));\n    return function approveEmployee(_x5, _x6) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n  var updateWallet = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(newAddress) {\n      return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n        while (1) switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.prev = 0;\n            _context7.next = 3;\n            return state.contract.methods.update_wallet_address(state.email, newAddress);\n          case 3:\n            _context7.next = 8;\n            break;\n          case 5:\n            _context7.prev = 5;\n            _context7.t0 = _context7[\"catch\"](0);\n            console.error(_context7.t0);\n          case 8:\n          case \"end\":\n            return _context7.stop();\n        }\n      }, _callee7, null, [[0, 5]]);\n    }));\n    return function updateWallet(_x7) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n  var approveManager = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(empId) {\n      return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n        while (1) switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.prev = 0;\n            _context8.next = 3;\n            return state.contract.methods.approve_manager(empId);\n          case 3:\n            _context8.next = 8;\n            break;\n          case 5:\n            _context8.prev = 5;\n            _context8.t0 = _context8[\"catch\"](0);\n            console.error(_context8.t0);\n          case 8:\n          case \"end\":\n            return _context8.stop();\n        }\n      }, _callee8, null, [[0, 5]]);\n    }));\n    return function approveManager(_x8) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n  var addCertificate = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(certUrl, issueDate, validTill, certName, issuer, linkedSkill) {\n      return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n        while (1) switch (_context9.prev = _context9.next) {\n          case 0:\n            _context9.prev = 0;\n            _context9.next = 3;\n            return state.contract.methods.add_certification(state.accountId, certUrl, issueDate, validTill, certName, issuer, linkedSkill);\n          case 3:\n            _context9.next = 8;\n            break;\n          case 5:\n            _context9.prev = 5;\n            _context9.t0 = _context9[\"catch\"](0);\n            console.error(_context9.t0);\n          case 8:\n          case \"end\":\n            return _context9.stop();\n        }\n      }, _callee9, null, [[0, 5]]);\n    }));\n    return function addCertificate(_x9, _x10, _x11, _x12, _x13, _x14) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n  var addSkill = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(skillName) {\n      return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n        while (1) switch (_context10.prev = _context10.next) {\n          case 0:\n            _context10.prev = 0;\n            _context10.next = 3;\n            return state.contract.methods.add_skill(state.accountId, skillName);\n          case 3:\n            _context10.next = 8;\n            break;\n          case 5:\n            _context10.prev = 5;\n            _context10.t0 = _context10[\"catch\"](0);\n            console.error(_context10.t0);\n          case 8:\n          case \"end\":\n            return _context10.stop();\n        }\n      }, _callee10, null, [[0, 5]]);\n    }));\n    return function addSkill(_x15) {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n  var endorseSkill = /*#__PURE__*/function () {\n    var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(empId, skillId, comment) {\n      var date;\n      return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n        while (1) switch (_context11.prev = _context11.next) {\n          case 0:\n            date = new Date();\n            _context11.prev = 1;\n            _context11.next = 4;\n            return state.contract.methods.endorse_skill(empId, skillId, \"\".concat(date.getMonth(), \" \").concat(date.getFullYear()), comment);\n          case 4:\n            _context11.next = 9;\n            break;\n          case 6:\n            _context11.prev = 6;\n            _context11.t0 = _context11[\"catch\"](1);\n            console.error(_context11.t0);\n          case 9:\n          case \"end\":\n            return _context11.stop();\n        }\n      }, _callee11, null, [[1, 6]]);\n    }));\n    return function endorseSkill(_x16, _x17, _x18) {\n      return _ref12.apply(this, arguments);\n    };\n  }();\n  // useEffect(() => {\n  //   initWeb3();\n  // });\n\n  return /*#__PURE__*/React.createElement(TransactionContext.Provider, {\n    value: {\n      connectWallet: connectWallet,\n      currentAccount: currentAccount,\n      login: login,\n      signUp: signUp,\n      requestCompany: requestCompany,\n      approveEmployee: approveEmployee,\n      updateWallet: updateWallet,\n      approveManager: approveManager,\n      addCertificate: addCertificate,\n      addSkill: addSkill,\n      endorseSkill: endorseSkill\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 6\n    }\n  }, children);\n};","map":{"version":3,"names":["React","useState","useEffect","Web3","workchop","TransactionContext","createContext","window","ethereum","TransactionProvider","children","web3","contract","email","account","accountId","signedIn","loaded","state","setState","currentAccount","setCurrentAccount","initWeb3","request","method","eth","getAccounts","net","getId","netId","address","networks","Contract","abi","methods","address_to_id","call","location","reload","console","log","alert","connectWallet","accounts","Error","login","from","accountType","error","signUp","sign_up","send","requestCompany","startDate","endDate","role","companyId","add_experience","approveEmployee","experienceId","approve_experience","updateWallet","newAddress","update_wallet_address","approveManager","empId","approve_manager","addCertificate","certUrl","issueDate","validTill","certName","issuer","linkedSkill","add_certification","addSkill","skillName","add_skill","endorseSkill","skillId","comment","date","Date","endorse_skill","getMonth","getFullYear"],"sources":["C:/Users/USER/Documents/Work_hub/src/context/TransactionContext.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Web3 from 'web3';\r\nimport workchop from '../abis/workchop.json';\r\nimport \"reactstrap/lib/\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\n\r\nexport const TransactionContext = React.createContext();\r\nconst { ethereum } = window;\r\nexport const TransactionProvider = ({ children }) => {\r\n  const [state, setState] = useState({\r\n    web3: null,\r\n    contract: null,\r\n    email: '',\r\n    account: '',\r\n    accountId: '',\r\n    signedIn: false,\r\n    loaded: false,\r\n  });\r\n  const [currentAccount, setCurrentAccount] = useState(\"\");\r\n\r\n  const initWeb3 = async () => {\r\n    if (window.ethereum) {\r\n      await window.ethereum.request({ method: 'eth_requestAccounts' });\r\n      try {\r\n        const web3 = new Web3(window.ethereum);\r\n        const account = (await web3.eth.getAccounts())[0];\r\n        const netId = await web3.eth.net.getId();\r\n        const address = workchop.networks[netId].address;\r\n        const contract = new web3.eth.Contract(workchop.abi, address);\r\n        const accountId = await contract.methods.address_to_id(account).call();\r\n        setState({\r\n          ...state,\r\n          web3,\r\n          account,\r\n          contract,\r\n          accountId,\r\n          loaded: true,\r\n        });\r\n        window.location.reload();\r\n        console.log('setup complete');\r\n      } catch (e) {\r\n        alert(e);\r\n      }\r\n    } else {\r\n      alert('web3 not detected');\r\n    }\r\n  };\r\n  const connectWallet = async () => {\r\n    try {\r\n      if (!ethereum) return alert(\"Please install MetaMask.\");\r\n\r\n      const accounts = await ethereum.request({ method: \"eth_requestAccounts\", });\r\n\r\n      setCurrentAccount(accounts[0]);\r\n      window.location.reload();\r\n    } catch (error) {\r\n      console.log(error);\r\n\r\n      throw new Error(\"No ethereum object\");\r\n    }\r\n  };\r\n\r\n  const login = async () => {\r\n    try {\r\n      const accountType = await state.contract.methods.login(state.email).call({\r\n        from: state.account,\r\n      });\r\n      console.log('account type:', accountType);\r\n      setState({ ...state, signedIn: true });\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const signUp = async () => {\r\n    try {\r\n      await state.contract.methods\r\n        .sign_up(state.email, 'name', 'user')\r\n        .send({ from: state.account });\r\n      alert('signed up');\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const requestCompany = async (startDate, endDate, role, companyId) => {\r\n    try {\r\n      await state.contract.methods.add_experience(\r\n        state.accountId,\r\n        startDate,\r\n        endDate,\r\n        role,\r\n        companyId\r\n      );\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const approveEmployee = async (experienceId, companyId) => {\r\n    try {\r\n      await state.contract.methods.approve_experience(experienceId, companyId);\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const updateWallet = async (newAddress) => {\r\n    try {\r\n      await state.contract.methods.update_wallet_address(state.email, newAddress);\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const approveManager = async (empId) => {\r\n    try {\r\n      await state.contract.methods.approve_manager(empId);\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const addCertificate = async (\r\n    certUrl,\r\n    issueDate,\r\n    validTill,\r\n    certName,\r\n    issuer,\r\n    linkedSkill\r\n  ) => {\r\n    try {\r\n      await state.contract.methods.add_certification(\r\n        state.accountId,\r\n        certUrl,\r\n        issueDate,\r\n        validTill,\r\n        certName,\r\n        issuer,\r\n        linkedSkill\r\n      );\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const addSkill = async (skillName) => {\r\n    try {\r\n      await state.contract.methods.add_skill(state.accountId, skillName);\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n\r\n  const endorseSkill = async (empId, skillId, comment) => {\r\n    const date = new Date();\r\n    try {\r\n      await state.contract.methods.endorse_skill(\r\n        empId,\r\n        skillId,\r\n        `${date.getMonth()} ${date.getFullYear()}`,\r\n        comment\r\n      );\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  };\r\n  // useEffect(() => {\r\n  //   initWeb3();\r\n  // });\r\n\r\n  \r\n    return (\r\n     <TransactionContext.Provider\r\n        value={{\r\n          connectWallet,\r\n          currentAccount,\r\n          login,\r\n          signUp,\r\n          requestCompany,\r\n          approveEmployee,\r\n          updateWallet,\r\n          approveManager,\r\n          addCertificate,\r\n          addSkill,\r\n          endorseSkill,\r\n\r\n\r\n\r\n        }}\r\n     >\r\n      {children}\r\n     </TransactionContext.Provider>\r\n\r\n    );\r\n  };\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}